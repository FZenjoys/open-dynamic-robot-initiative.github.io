\hypertarget{classrobot__interfaces_1_1MonitoredRobotDriver}{}\section{robot\+\_\+interfaces\+:\+:Monitored\+Robot\+Driver$<$ Driver $>$ Class Template Reference}
\label{classrobot__interfaces_1_1MonitoredRobotDriver}\index{robot\+\_\+interfaces\+::\+Monitored\+Robot\+Driver$<$ Driver $>$@{robot\+\_\+interfaces\+::\+Monitored\+Robot\+Driver$<$ Driver $>$}}


Wrapper for \hyperlink{classrobot__interfaces_1_1RobotDriver}{Robot\+Driver} that monitors timing.  




{\ttfamily \#include $<$monitored\+\_\+robot\+\_\+driver.\+hpp$>$}



Inheritance diagram for robot\+\_\+interfaces\+:\+:Monitored\+Robot\+Driver$<$ Driver $>$\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=225pt]{classrobot__interfaces_1_1MonitoredRobotDriver__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for robot\+\_\+interfaces\+:\+:Monitored\+Robot\+Driver$<$ Driver $>$\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=225pt]{classrobot__interfaces_1_1MonitoredRobotDriver__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Types}
\begin{DoxyCompactItemize}
\item 
typedef std\+::shared\+\_\+ptr$<$ \hyperlink{classDriver}{Driver} $>$ {\bfseries Robot\+Driver\+Ptr}\hypertarget{classrobot__interfaces_1_1MonitoredRobotDriver_a272fbf2c9bf93f568c00dd1e37e62e97}{}\label{classrobot__interfaces_1_1MonitoredRobotDriver_a272fbf2c9bf93f568c00dd1e37e62e97}

\end{DoxyCompactItemize}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classrobot__interfaces_1_1MonitoredRobotDriver_a2ea1456e85ad7596295cb047e552dc06}{Monitored\+Robot\+Driver} (Robot\+Driver\+Ptr robot\+\_\+driver, const double max\+\_\+action\+\_\+duration\+\_\+s, const double max\+\_\+inter\+\_\+action\+\_\+duration\+\_\+s)
\begin{DoxyCompactList}\small\item\em Starts a thread for monitoring timing of action execution. \end{DoxyCompactList}\item 
\hyperlink{classrobot__interfaces_1_1MonitoredRobotDriver_a07dfd2cc6f1dc07fad82914814a43188}{$\sim$\+Monitored\+Robot\+Driver} ()\hypertarget{classrobot__interfaces_1_1MonitoredRobotDriver_a07dfd2cc6f1dc07fad82914814a43188}{}\label{classrobot__interfaces_1_1MonitoredRobotDriver_a07dfd2cc6f1dc07fad82914814a43188}

\begin{DoxyCompactList}\small\item\em Shuts down the robot and stops the monitoring thread. \end{DoxyCompactList}\item 
virtual Driver\+::\+Action \hyperlink{classrobot__interfaces_1_1MonitoredRobotDriver_a3f0f7cbf74236e91d33dcfc08206b5e9}{apply\+\_\+action} (const typename Driver\+::\+Action \&desired\+\_\+action) final
\begin{DoxyCompactList}\small\item\em Apply desired action on the robot. \end{DoxyCompactList}\item 
virtual void \hyperlink{classrobot__interfaces_1_1MonitoredRobotDriver_a47b68c24afaa087e4e60e6413ab7ac89}{initialize} ()
\begin{DoxyCompactList}\small\item\em Initialize the robot. \end{DoxyCompactList}\item 
virtual Driver\+::\+Observation \hyperlink{classrobot__interfaces_1_1MonitoredRobotDriver_a97774dddcda1038f338d18ef0b572ad8}{get\+\_\+latest\+\_\+observation} ()
\begin{DoxyCompactList}\small\item\em Return the latest observation immediately. \end{DoxyCompactList}\item 
virtual std\+::string \hyperlink{classrobot__interfaces_1_1MonitoredRobotDriver_a944425cc7e0845184f33b16405a9e61e}{get\+\_\+error} ()
\begin{DoxyCompactList}\small\item\em Get error message if there is any error. \end{DoxyCompactList}\item 
virtual void \hyperlink{classrobot__interfaces_1_1MonitoredRobotDriver_a95714a60e69a3ac06461382a7b391289}{shutdown} () final
\begin{DoxyCompactList}\small\item\em Shut down the robot safely. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{classrobot__interfaces_1_1MonitoredRobotDriver_a6ed3d940dce484dcdc558a52a8dfe8a5}{loop} ()
\begin{DoxyCompactList}\small\item\em Monitor the timing of action execution. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Static Private Member Functions}
\begin{DoxyCompactItemize}
\item 
static void $\ast$ {\bfseries loop} (void $\ast$instance\+\_\+pointer)\hypertarget{classrobot__interfaces_1_1MonitoredRobotDriver_a46ddb0472196631d6cdd109f3753c693}{}\label{classrobot__interfaces_1_1MonitoredRobotDriver_a46ddb0472196631d6cdd109f3753c693}

\end{DoxyCompactItemize}
\subsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
Robot\+Driver\+Ptr \hyperlink{classrobot__interfaces_1_1MonitoredRobotDriver_ae43540d38c9414d8ad734a9c88155a6e}{robot\+\_\+driver\+\_\+}\hypertarget{classrobot__interfaces_1_1MonitoredRobotDriver_ae43540d38c9414d8ad734a9c88155a6e}{}\label{classrobot__interfaces_1_1MonitoredRobotDriver_ae43540d38c9414d8ad734a9c88155a6e}

\begin{DoxyCompactList}\small\item\em The actual robot driver. \end{DoxyCompactList}\item 
double \hyperlink{classrobot__interfaces_1_1MonitoredRobotDriver_a860e5a4835a916faf08e1ab932b34bb1}{max\+\_\+action\+\_\+duration\+\_\+s\+\_\+}\hypertarget{classrobot__interfaces_1_1MonitoredRobotDriver_a860e5a4835a916faf08e1ab932b34bb1}{}\label{classrobot__interfaces_1_1MonitoredRobotDriver_a860e5a4835a916faf08e1ab932b34bb1}

\begin{DoxyCompactList}\small\item\em Max. time for executing an action. \end{DoxyCompactList}\item 
double \hyperlink{classrobot__interfaces_1_1MonitoredRobotDriver_acef35c51b51f1d05453b5b672f43a516}{max\+\_\+inter\+\_\+action\+\_\+duration\+\_\+s\+\_\+}\hypertarget{classrobot__interfaces_1_1MonitoredRobotDriver_acef35c51b51f1d05453b5b672f43a516}{}\label{classrobot__interfaces_1_1MonitoredRobotDriver_acef35c51b51f1d05453b5b672f43a516}

\begin{DoxyCompactList}\small\item\em Max. idle time between actions. \end{DoxyCompactList}\item 
std\+::atomic$<$ bool $>$ \hyperlink{classrobot__interfaces_1_1MonitoredRobotDriver_a8200e14e4d9e4d1d8c2fc4e0134cf7cd}{is\+\_\+shutdown\+\_\+}\hypertarget{classrobot__interfaces_1_1MonitoredRobotDriver_a8200e14e4d9e4d1d8c2fc4e0134cf7cd}{}\label{classrobot__interfaces_1_1MonitoredRobotDriver_a8200e14e4d9e4d1d8c2fc4e0134cf7cd}

\begin{DoxyCompactList}\small\item\em Whether shutdown was initiated. \end{DoxyCompactList}\item 
time\+\_\+series\+::\+Time\+Series$<$ bool $>$ {\bfseries action\+\_\+start\+\_\+logger\+\_\+}\hypertarget{classrobot__interfaces_1_1MonitoredRobotDriver_a5c02465be067a76143495c47469d0ae3}{}\label{classrobot__interfaces_1_1MonitoredRobotDriver_a5c02465be067a76143495c47469d0ae3}

\item 
time\+\_\+series\+::\+Time\+Series$<$ bool $>$ {\bfseries action\+\_\+end\+\_\+logger\+\_\+}\hypertarget{classrobot__interfaces_1_1MonitoredRobotDriver_a469ee1c7ec3565e391c9ac1758b702f6}{}\label{classrobot__interfaces_1_1MonitoredRobotDriver_a469ee1c7ec3565e391c9ac1758b702f6}

\item 
std\+::shared\+\_\+ptr$<$ real\+\_\+time\+\_\+tools\+::\+Real\+Time\+Thread $>$ {\bfseries thread\+\_\+}\hypertarget{classrobot__interfaces_1_1MonitoredRobotDriver_aaa3c0cd73914d3d3118a78252ed13631}{}\label{classrobot__interfaces_1_1MonitoredRobotDriver_aaa3c0cd73914d3d3118a78252ed13631}

\item 
real\+\_\+time\+\_\+tools\+::\+Singletype\+Threadsafe\+Object$<$ std\+::string, 1 $>$ {\bfseries error\+\_\+message\+\_\+}\hypertarget{classrobot__interfaces_1_1MonitoredRobotDriver_a123c65db418751fccfd681e0cc53348a}{}\label{classrobot__interfaces_1_1MonitoredRobotDriver_a123c65db418751fccfd681e0cc53348a}

\end{DoxyCompactItemize}


\subsection{Detailed Description}
\subsubsection*{template$<$typename Driver$>$\\*
class robot\+\_\+interfaces\+::\+Monitored\+Robot\+Driver$<$ Driver $>$}

Wrapper for \hyperlink{classrobot__interfaces_1_1RobotDriver}{Robot\+Driver} that monitors timing. 

Takes a \hyperlink{classrobot__interfaces_1_1RobotDriver}{Robot\+Driver} instance as input and forwards all method calls to it. A background loop monitors timing of actions to ensure the following constraints\+:


\begin{DoxyEnumerate}
\item The execution of an action does not take longer than {\ttfamily max\+\_\+action\+\_\+duration\+\_\+s\+\_\+} seconds.
\item The time interval between termination of the previous action and receival of the next one (through {\ttfamily \hyperlink{classrobot__interfaces_1_1MonitoredRobotDriver_a3f0f7cbf74236e91d33dcfc08206b5e9}{apply\+\_\+action()}}) does not exceed {\ttfamily max\+\_\+inter\+\_\+action\+\_\+duration\+\_\+s\+\_\+}.
\end{DoxyEnumerate}

If these timing constraints are not satisfied, the robot will be shutdown, and no more actions from the outside will be accepted.

This wrapper also makes sure that the {\ttfamily \hyperlink{classrobot__interfaces_1_1MonitoredRobotDriver_a95714a60e69a3ac06461382a7b391289}{shutdown()}} method of the given \hyperlink{classrobot__interfaces_1_1RobotDriver}{Robot\+Driver} is called when wrapper is destroyed, so the robot should always be left in a safe state.


\begin{DoxyTemplParams}{Template Parameters}
{\em \hyperlink{classAction}{Action}} & \\
\hline
{\em \hyperlink{classObservation}{Observation}} & \\
\hline
\end{DoxyTemplParams}
\begin{Desc}
\item[Examples\+: ]\par
\hyperlink{demo_8cpp-example}{demo.\+cpp}.\end{Desc}


\subsection{Constructor \& Destructor Documentation}
\index{robot\+\_\+interfaces\+::\+Monitored\+Robot\+Driver@{robot\+\_\+interfaces\+::\+Monitored\+Robot\+Driver}!Monitored\+Robot\+Driver@{Monitored\+Robot\+Driver}}
\index{Monitored\+Robot\+Driver@{Monitored\+Robot\+Driver}!robot\+\_\+interfaces\+::\+Monitored\+Robot\+Driver@{robot\+\_\+interfaces\+::\+Monitored\+Robot\+Driver}}
\subsubsection[{\texorpdfstring{Monitored\+Robot\+Driver(\+Robot\+Driver\+Ptr robot\+\_\+driver, const double max\+\_\+action\+\_\+duration\+\_\+s, const double max\+\_\+inter\+\_\+action\+\_\+duration\+\_\+s)}{MonitoredRobotDriver(RobotDriverPtr robot_driver, const double max_action_duration_s, const double max_inter_action_duration_s)}}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename Driver $>$ {\bf robot\+\_\+interfaces\+::\+Monitored\+Robot\+Driver}$<$ {\bf Driver} $>$\+::{\bf Monitored\+Robot\+Driver} (
\begin{DoxyParamCaption}
\item[{Robot\+Driver\+Ptr}]{robot\+\_\+driver, }
\item[{const double}]{max\+\_\+action\+\_\+duration\+\_\+s, }
\item[{const double}]{max\+\_\+inter\+\_\+action\+\_\+duration\+\_\+s}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{classrobot__interfaces_1_1MonitoredRobotDriver_a2ea1456e85ad7596295cb047e552dc06}{}\label{classrobot__interfaces_1_1MonitoredRobotDriver_a2ea1456e85ad7596295cb047e552dc06}


Starts a thread for monitoring timing of action execution. 


\begin{DoxyParams}{Parameters}
{\em robot\+\_\+driver} & The actual robot driver instance. \\
\hline
{\em max\+\_\+action\+\_\+duration\+\_\+s} & Maximum time allowed for an action to be executed. \\
\hline
{\em max\+\_\+inter\+\_\+action\+\_\+duration\+\_\+s} & Maximum time allowed between end of the previous action and receival of the next one. \\
\hline
\end{DoxyParams}


\subsection{Member Function Documentation}
\index{robot\+\_\+interfaces\+::\+Monitored\+Robot\+Driver@{robot\+\_\+interfaces\+::\+Monitored\+Robot\+Driver}!apply\+\_\+action@{apply\+\_\+action}}
\index{apply\+\_\+action@{apply\+\_\+action}!robot\+\_\+interfaces\+::\+Monitored\+Robot\+Driver@{robot\+\_\+interfaces\+::\+Monitored\+Robot\+Driver}}
\subsubsection[{\texorpdfstring{apply\+\_\+action(const typename Driver\+::\+Action \&desired\+\_\+action) final}{apply_action(const typename Driver::Action &desired_action) final}}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename Driver $>$ virtual Driver\+::\+Action {\bf robot\+\_\+interfaces\+::\+Monitored\+Robot\+Driver}$<$ {\bf Driver} $>$\+::apply\+\_\+action (
\begin{DoxyParamCaption}
\item[{const typename Driver\+::\+Action \&}]{desired\+\_\+action}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [final]}, {\ttfamily [virtual]}}\hypertarget{classrobot__interfaces_1_1MonitoredRobotDriver_a3f0f7cbf74236e91d33dcfc08206b5e9}{}\label{classrobot__interfaces_1_1MonitoredRobotDriver_a3f0f7cbf74236e91d33dcfc08206b5e9}


Apply desired action on the robot. 

If the robot is shut down, no more actions will be applied (the method will just ignore them silently.


\begin{DoxyParams}{Parameters}
{\em desired\+\_\+action} & The desired action. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The action that is actually applied on the robot (may differ from desired action due to safety limitations). 
\end{DoxyReturn}
\index{robot\+\_\+interfaces\+::\+Monitored\+Robot\+Driver@{robot\+\_\+interfaces\+::\+Monitored\+Robot\+Driver}!get\+\_\+error@{get\+\_\+error}}
\index{get\+\_\+error@{get\+\_\+error}!robot\+\_\+interfaces\+::\+Monitored\+Robot\+Driver@{robot\+\_\+interfaces\+::\+Monitored\+Robot\+Driver}}
\subsubsection[{\texorpdfstring{get\+\_\+error()}{get_error()}}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename Driver $>$ virtual std\+::string {\bf robot\+\_\+interfaces\+::\+Monitored\+Robot\+Driver}$<$ {\bf Driver} $>$\+::get\+\_\+error (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}\hypertarget{classrobot__interfaces_1_1MonitoredRobotDriver_a944425cc7e0845184f33b16405a9e61e}{}\label{classrobot__interfaces_1_1MonitoredRobotDriver_a944425cc7e0845184f33b16405a9e61e}


Get error message if there is any error. 

\begin{DoxyReturn}{Returns}
Returns an error message or an empty string if there is no error. 
\end{DoxyReturn}


Implements \hyperlink{classrobot__interfaces_1_1RobotDriver_acdf4c5d6993b836a180e6b6fc12b3445}{robot\+\_\+interfaces\+::\+Robot\+Driver$<$ Driver\+::\+Action, Driver\+::\+Observation $>$}.

\index{robot\+\_\+interfaces\+::\+Monitored\+Robot\+Driver@{robot\+\_\+interfaces\+::\+Monitored\+Robot\+Driver}!get\+\_\+latest\+\_\+observation@{get\+\_\+latest\+\_\+observation}}
\index{get\+\_\+latest\+\_\+observation@{get\+\_\+latest\+\_\+observation}!robot\+\_\+interfaces\+::\+Monitored\+Robot\+Driver@{robot\+\_\+interfaces\+::\+Monitored\+Robot\+Driver}}
\subsubsection[{\texorpdfstring{get\+\_\+latest\+\_\+observation()}{get_latest_observation()}}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename Driver $>$ virtual Driver\+::\+Observation {\bf robot\+\_\+interfaces\+::\+Monitored\+Robot\+Driver}$<$ {\bf Driver} $>$\+::get\+\_\+latest\+\_\+observation (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}\hypertarget{classrobot__interfaces_1_1MonitoredRobotDriver_a97774dddcda1038f338d18ef0b572ad8}{}\label{classrobot__interfaces_1_1MonitoredRobotDriver_a97774dddcda1038f338d18ef0b572ad8}


Return the latest observation immediately. 

\begin{DoxyReturn}{Returns}
\hyperlink{classObservation}{Observation} 
\end{DoxyReturn}


Implements \hyperlink{classrobot__interfaces_1_1RobotDriver_ad13d4f4fdfe78bdde4fc964f07fa45e2}{robot\+\_\+interfaces\+::\+Robot\+Driver$<$ Driver\+::\+Action, Driver\+::\+Observation $>$}.

\index{robot\+\_\+interfaces\+::\+Monitored\+Robot\+Driver@{robot\+\_\+interfaces\+::\+Monitored\+Robot\+Driver}!initialize@{initialize}}
\index{initialize@{initialize}!robot\+\_\+interfaces\+::\+Monitored\+Robot\+Driver@{robot\+\_\+interfaces\+::\+Monitored\+Robot\+Driver}}
\subsubsection[{\texorpdfstring{initialize()}{initialize()}}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename Driver $>$ virtual void {\bf robot\+\_\+interfaces\+::\+Monitored\+Robot\+Driver}$<$ {\bf Driver} $>$\+::initialize (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}\hypertarget{classrobot__interfaces_1_1MonitoredRobotDriver_a47b68c24afaa087e4e60e6413ab7ac89}{}\label{classrobot__interfaces_1_1MonitoredRobotDriver_a47b68c24afaa087e4e60e6413ab7ac89}


Initialize the robot. 

Any initialization procedures that need to be done before sending actions to the robot should be done in this method (e.\+g. homing to find the absolute position). 

Implements \hyperlink{classrobot__interfaces_1_1RobotDriver_af3cbef570a455e1f8085d701282264ff}{robot\+\_\+interfaces\+::\+Robot\+Driver$<$ Driver\+::\+Action, Driver\+::\+Observation $>$}.

\index{robot\+\_\+interfaces\+::\+Monitored\+Robot\+Driver@{robot\+\_\+interfaces\+::\+Monitored\+Robot\+Driver}!loop@{loop}}
\index{loop@{loop}!robot\+\_\+interfaces\+::\+Monitored\+Robot\+Driver@{robot\+\_\+interfaces\+::\+Monitored\+Robot\+Driver}}
\subsubsection[{\texorpdfstring{loop()}{loop()}}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename Driver $>$ void {\bf robot\+\_\+interfaces\+::\+Monitored\+Robot\+Driver}$<$ {\bf Driver} $>$\+::loop (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}\hypertarget{classrobot__interfaces_1_1MonitoredRobotDriver_a6ed3d940dce484dcdc558a52a8dfe8a5}{}\label{classrobot__interfaces_1_1MonitoredRobotDriver_a6ed3d940dce484dcdc558a52a8dfe8a5}


Monitor the timing of action execution. 

If one of the timing constrains is violated, the robot is immediately shut down. \index{robot\+\_\+interfaces\+::\+Monitored\+Robot\+Driver@{robot\+\_\+interfaces\+::\+Monitored\+Robot\+Driver}!shutdown@{shutdown}}
\index{shutdown@{shutdown}!robot\+\_\+interfaces\+::\+Monitored\+Robot\+Driver@{robot\+\_\+interfaces\+::\+Monitored\+Robot\+Driver}}
\subsubsection[{\texorpdfstring{shutdown() final}{shutdown() final}}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename Driver $>$ virtual void {\bf robot\+\_\+interfaces\+::\+Monitored\+Robot\+Driver}$<$ {\bf Driver} $>$\+::shutdown (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [final]}, {\ttfamily [virtual]}}\hypertarget{classrobot__interfaces_1_1MonitoredRobotDriver_a95714a60e69a3ac06461382a7b391289}{}\label{classrobot__interfaces_1_1MonitoredRobotDriver_a95714a60e69a3ac06461382a7b391289}


Shut down the robot safely. 

After shutdown, actions sent by the user are ignored. 

Implements \hyperlink{classrobot__interfaces_1_1RobotDriver_a3451fb8b15d2840b559f3ee858de01f8}{robot\+\_\+interfaces\+::\+Robot\+Driver$<$ Driver\+::\+Action, Driver\+::\+Observation $>$}.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
include/robot\+\_\+interfaces/monitored\+\_\+robot\+\_\+driver.\+hpp\end{DoxyCompactItemize}
